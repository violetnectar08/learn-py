(self.webpackChunk_aquirdturtle_collapsible_headings=self.webpackChunk_aquirdturtle_collapsible_headings||[]).push([[568],{568:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>x});var l=n(120),d=n(751),o=n(238),i=n(879),r=n(286);const c={activate:function(e,t,n,l,i){console.log("JupyterLab extension @aquirdturtle/collapsible_headings is activated!!"),l.load(c.id).then((e=>a(0)));const r="Collapsible_Headings:Toggle_Collapse",v="Collapsible_Headings:Manually_Update_Collapse_Buttons",x="Collapsible_Headings:Manually_Update_Notebook_Collapse_State",I="Collapsible_Headings:Collapse_All",_="Collapsible_Headings:UnCollapse_All",y="Collapsible_Headings:Add_Header_Above",k="Collapsible_Headings:Add_Header_Below",N="Collapsible_Headings:Uncollapse_Header",E="Collapsible_Headings:Collapse_Header",A="Collapsible_Headings:HandleUp",L="Collapsible_Headings:HandleDown";e.commands.addCommand(r,{label:"Toggle Collapse",execute:()=>{W(t)}}),e.commands.addCommand(v,{label:"Refresh Collapse Buttons",execute:()=>{C(t)}}),e.commands.addCommand(x,{label:"Refresh Notebook Collapse State",execute:()=>{m(t)}}),e.commands.addCommand(I,{label:"Collapse All Cells",execute:()=>{!function(e){if(a(),e.currentWidget)for(let t=0;t<e.currentWidget.content.widgets.length;t++){let n=e.currentWidget.content.widgets[t];w(n).isHeader&&(h(e,t,!0),H(n,!0),f(p(n,e),!0,w(n).headerLevel))}m(e)}(t)}}),e.commands.addCommand(_,{label:"Un-Collapse All Cells",execute:()=>{!function(e){if(a(),e.currentWidget)for(let t=0;t<e.currentWidget.content.widgets.length;t++){let n=e.currentWidget.content.widgets[t];w(n).isHeader&&(h(e,t,!1),H(n,!1),f(p(n,e),!1,w(n).headerLevel))}m(e)}(t)}}),e.commands.addCommand(y,{label:"Add Header Above",execute:()=>{!function(e){if(!e.activeCell)return;let t=w(e.activeCell);if(!t.isHeader){let n=g(e.currentWidget.content.activeCellIndex,e);t=w(e.currentWidget.content.widgets[n])}0==t.isHeader&&a(),d.NotebookActions.insertAbove(e.currentWidget.content),d.NotebookActions.setMarkdownHeader(e.currentWidget.content,t.headerLevel),d.NotebookActions.changeCellType(e.currentWidget.content,"markdown"),a(e.activeCell),e.activeCell.editor.setSelection({start:{line:0,column:t.headerLevel+1},end:{line:0,column:10}}),e.activeCell.editor.focus(),a()}(t)}}),e.commands.addCommand(k,{label:"Add Header Below",execute:()=>{!function(e){if(!e.activeCell)return;let t=w(e.activeCell);if(!t.isHeader){let n=g(e.currentWidget.content.activeCellIndex,e);t=w(e.currentWidget.content.widgets[n])}let n=u(e.currentWidget.content.activeCellIndex,e);0==t.isHeader&&a(),e.currentWidget.content.activeCellIndex=n,d.NotebookActions.insertAbove(e.currentWidget.content),d.NotebookActions.setMarkdownHeader(e.currentWidget.content,t.headerLevel),d.NotebookActions.changeCellType(e.currentWidget.content,"markdown"),e.activeCell.editor.setSelection({start:{line:0,column:t.headerLevel+1},end:{line:0,column:10}}),e.activeCell.editor.focus(),a()}(t)}}),e.commands.addCommand(N,{label:"Un-Collapse Header",execute:()=>{!function(e){if(e.activeCell){if(w(e.activeCell).isHeader)h(e,e.currentWidget.content.activeCellIndex,!1);else{let t=u(e.currentWidget.content.activeCellIndex,e);if(-1==t)return;e.currentWidget.content.activeCellIndex=t}o.ElementExt.scrollIntoViewIfNeeded(e.currentWidget.content.node,e.activeCell.node)}}(t)}}),e.commands.addCommand(E,{label:"Collapse Header",execute:()=>{!function(e){if(e.activeCell){if(w(e.activeCell).isHeader)if(b(e.activeCell)){let t=g(e.currentWidget.content.activeCellIndex,e);if(-1==t)return;e.currentWidget.content.activeCellIndex=t}else h(e,e.currentWidget.content.activeCellIndex,!0);else{let t=g(e.currentWidget.content.activeCellIndex,e);if(-1==t)return;e.currentWidget.content.activeCellIndex=t}o.ElementExt.scrollIntoViewIfNeeded(e.currentWidget.content.node,e.activeCell.node)}}(t)}}),e.commands.addCommand(A,{label:"Handle Up Arrow",execute:()=>{!function(e){if(a(),0==e.currentWidget.content.activeCellIndex)return;e.currentWidget.content.deselectAll();let t=e.currentWidget.content.activeCellIndex-1;if(e.currentWidget.content.widgets[t].isHidden){let n=function(e,t){if(e>=t.currentWidget.content.widgets.length)return-1;for(;e>0;)if(e-=1,!t.currentWidget.content.widgets[e].isHidden)return e;return-1}(t,e);if(-1==n)return;a(),e.currentWidget.content.activeCellIndex=n}else a(),e.currentWidget.content.activeCellIndex-=1;o.ElementExt.scrollIntoViewIfNeeded(e.currentWidget.content.node,e.activeCell.node)}(t)}}),e.commands.addCommand(L,{label:"Handle Down Arrow",execute:()=>{!function(e){a(),e.currentWidget.content.deselectAll();let t=e.currentWidget.content.activeCellIndex+1;if(!(t>=e.currentWidget.content.widgets.length)){if(e.currentWidget.content.widgets[t].isHidden){let n=function(e,t){if(e>=t.currentWidget.content.widgets.length||e<0)return-1;for(;e<t.currentWidget.content.widgets.length-1;)if(e+=1,!t.currentWidget.content.widgets[e].isHidden)return e;return-1}(t,e);if(-1==n)return;a(),e.currentWidget.content.activeCellIndex=n}else a(),e.currentWidget.content.activeCellIndex+=1;o.ElementExt.scrollIntoViewIfNeeded(e.currentWidget.content.node,e.activeCell.node)}}(t)}}),n.addItem({command:r,category:"Collapsible Headings Extension"}),n.addItem({command:v,category:"Collapsible Headings Extension"}),n.addItem({command:x,category:"Collapsible Headings Extension"}),n.addItem({command:I,category:"Collapsible Headings Extension"}),n.addItem({command:_,category:"Collapsible Headings Extension"}),n.addItem({command:y,category:"Collapsible Headings Extension"}),n.addItem({command:k,category:"Collapsible Headings Extension"}),n.addItem({command:N,category:"Collapsible Headings Extension"}),n.addItem({command:E,category:"Collapsible Headings Extension"}),n.addItem({command:A,category:"Collapsible Headings Extension"}),n.addItem({command:L,category:"Collapsible Headings Extension"}),t.currentChanged.connect((()=>{t.currentWidget.content.model.stateChanged.connect((()=>{t.currentWidget.content.widgets.length>1&&(C(t),setTimeout((()=>{m(t)}),10))}))})),d.NotebookActions.executed.connect((()=>{a(),C(t)})),setTimeout((()=>{e.commands.addKeyBinding({command:A,args:{},keys:["ArrowUp"],selector:".jp-Notebook:focus"})}),2e3),setTimeout((()=>{e.commands.addKeyBinding({command:A,args:{},keys:["K"],selector:".jp-Notebook:focus"})}),2e3),setTimeout((()=>{e.commands.addKeyBinding({command:L,args:{},keys:["ArrowDown"],selector:".jp-Notebook:focus"})}),2e3),setTimeout((()=>{e.commands.addKeyBinding({command:L,args:{},keys:["J"],selector:".jp-Notebook:focus"})}),2e3),t.activeCellChanged.connect((()=>{!function(e){s(e.currentWidget.content.activeCellIndex,e)}(t)})),i.collapseChanged.connect((()=>{setTimeout((()=>{m(t)}),10)}))},requires:[d.INotebookTracker,l.ICommandPalette,i.ISettingRegistry,r.ITableOfContentsRegistry],id:"@aquirdturtle/collapsible_headings:plugin",autoStart:!0};function a(e,...t){}function s(e,t){let n=g(e,t);if(-1==n)return;let l=t.currentWidget.content.widgets[n];(b(l)||l.isHidden)&&(l.isHidden&&s(n,t),b(l)&&h(t,n,!1))}function u(e,t){if(e>=t.currentWidget.content.widgets.length)return-1;let n=w(t.currentWidget.content.widgets[e]);for(let l=e+1;l<t.currentWidget.content.widgets.length;l++){let e=w(t.currentWidget.content.widgets[l]);if(e.isHeader&&e.headerLevel<=n.headerLevel)return l}return t.currentWidget.content.widgets.length-1}function g(e,t){if(e>=t.currentWidget.content.widgets.length)return-1;let n=w(t.currentWidget.content.widgets[e]);for(let l=e-1;l>=0;l--)if(l<t.currentWidget.content.widgets.length){let e=w(t.currentWidget.content.widgets[l]);if(e.isHeader&&e.headerLevel<n.headerLevel)return l}return-1}function m(e){let t=0,n=0;if(e.currentWidget)for(;t<e.currentWidget.content.widgets.length&&n<1e6;)t=h(e,t,b(e.currentWidget.content.widgets[t])),n+=1}function C(e){let t=e.currentWidget.content.widgets;for(let l=0;l<t.length;l++){let d=t[l];w(d).isHeader?v(d,e):0!=(n=d).promptNode.getElementsByClassName("ch-button").length&&n.promptNode.removeChild(n.promptNode.getElementsByClassName("ch-button")[0])}var n}function f(e,t,n){e.style.background=t?"var(--jp-icon-caret-right) no-repeat center":"var(--jp-icon-caret-down) no-repeat center",e.style.position="relative",e.style.backgroundSize="30px 30px";let l=4*n-15;e.style.bottom=l.toString()+"px"}function p(e,t){if(0==e.promptNode.getElementsByClassName("ch-button").length){let n=e.promptNode.appendChild(document.createElement("button"));return n.className="bp3-button bp3-minimal jp-Button minimal ch-button",n.onclick=()=>{W(t)},n}return e.promptNode.getElementsByClassName("ch-button")[0]}function v(e,t){f(p(e,t),b(e),w(e).headerLevel)}function h(e,t,n){if(!e)return t+1;e.currentWidget.content.widgets.length;let l=e.currentWidget.content.widgets[t];if(!l)return t+1;let d=w(l),o=!1;if(null==l)return;for(let e=0;e<l.node.classList.length;e++)"jp-MarkdownCell"==l.node.classList[e]&&(o=!0);if(l.isHidden||!o||!d.isHeader)return t+1;H(l,n),f(p(l,e),n,w(l).headerLevel);let i=!1,r=0,c=t+1;for(c=t+1;c<e.currentWidget.content.widgets.length;c++){let t=e.currentWidget.content.widgets[c],l=w(t);if(l.isHeader&&l.headerLevel<=d.headerLevel){c-=1;break}i&&l.isHeader&&l.headerLevel<=r&&(i=!1),n||i?t.setHidden(!0):(b(t)&&l.isHeader&&(i=!0,r=l.headerLevel),l.isHeader&&f(p(t,e),i,r),t.setHidden(!1))}return c+1}function W(e){if(e.activeCell){if(w(e.activeCell).isHeader){let t=!b(e.activeCell);h(e,e.currentWidget.content.activeCellIndex,t)}else{let t=g(e.currentWidget.content.activeCellIndex,e);if(-1==t)return;h(e,t,!b(e.currentWidget.content.widgets[t])),e.currentWidget.content.activeCellIndex=t}o.ElementExt.scrollIntoViewIfNeeded(e.currentWidget.content.node,e.activeCell.node)}}function b(e){let t=e.model.metadata,n=!1;return t.has("toc-hr-collapsed")&&(n=!0===t.get("toc-hr-collapsed")),n}function H(e,t){let n=e.model.metadata;t?n.set("toc-hr-collapsed",!0):n.delete("toc-hr-collapsed")}function w(e){let t=!1;if(null==e)return;for(let n=0;n<e.node.classList.length;n++)"jp-MarkdownCell"==e.node.classList[n]&&(t=!0);if(!t)return{isHeader:!1,headerLevel:7};const n=e.model.value.text.split("\n"),l=n[0],d=n.length>1?n[1]:void 0;let o=l.match(/^([#]{1,6}) (.*)/),i=d&&d.match(/^([=]{2,}|[-]{2,})/),r=l.match(/<h([1-6])(.*)>(.*)<\/h\1>/i),c=null!==o||null!=i&&!1!==Boolean(i)||null!==r,a=7;return o?a=o[1].length:i?a="="===i[1][0]?1:2:r&&(a=parseInt(r[1],10)),{isHeader:c,headerLevel:a}}const x=c}}]);